// ==UserScript==
// @name        Dark Hole - Twitter Bookmarks
// @description Automated content deletion
// @namespace   https://github.com/geotrev/dark-hole
// @author      George Treviranus
// @run-at      document-idle
// @match       https://twitter.com/i/bookmarks
// @version     0.0.0
// @downloadURL https://github.com/geotrev/dark-hole/raw/main/dist/twitter-bookmarks.user.js
// @updateURL   https://github.com/geotrev/dark-hole/raw/main/dist/twitter-bookmarks.user.js
// @grant       none
// ==/UserScript==
!function(){"use strict";const e=e=>{[["display","inline-block"],["border","none"],["margin","0"],["textDecoration","none"],["fontFamily","inherit"],["fontSize","inherit"],["lineHeight","1"],["cursor","pointer"],["textAlign","center"]].forEach((([t,n])=>{e.style[t]=n})),[["transition","background 0.2s ease-in-out"],["marginInlineEnd","8px"],["backgroundColor","white"],["color","#222"],["appearance","none"],["borderRadius","2px"],["padding","6px 10px"]].forEach((([t,n])=>{e.style[t]=n}))};const t=new class{static queue=0;static DEFAULT_DELAY=2e3;constructor(){this.notifyWrapper=this.buildNotifyContainer(),this.notifyEl=this.buildNotification(),document.body.appendChild(this.notifyWrapper),document.addEventListener("keydown",this.handleKeyDown,!0)}handleKeyDown=e=>{this.queueIsEmpty()||"Escape"!==e.key||(e.preventDefault(),this.dismiss())};queueIsEmpty=()=>this.queue<=0;buildNotifyContainer=()=>{const e=document.createElement("div");return e.style.fontFamily="-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif",e.style.position="fixed",e.style.top="0px",e.style.right="0px",e.style.bottom="unset",e.style.left="0px",e.style.zIndex="4000",e.style.padding="32px",e.style.pointerEvents="none",e.style.display="flex",e.style.flexDirection="column",e.style.alignItems="flex-end",e.dataset.dhNotifyContainer=!0,e};buildNotification=()=>{const e=document.createElement("section");e.style.pointerEvents="auto",e.style.flexWrap="wrap",e.style.backgroundColor="#333",e.style.margin="0px",e.style.color="#dedede",e.style.padding="20px",e.style.borderRadius="8px",e.style.maxWidth="280px",e.style.boxShadow="0 5px 10px rgba(0,0,0,0.5)",e.style.marginBottom="12px";const t=document.createElement("h3");t.style.marginBottom="8px",t.style.marginTop="0",t.style.padding="0",t.style.fontWeight="bold",t.style.fontSize="12px";const n=document.createElement("p");return n.style.fontSize="16px",n.style.lineHeight="22px",n.style.padding="0",n.style.margin="0 0 12px 0",e.dataset.dhNotify=!0,t.dataset.dhNotifyHeading=!0,n.dataset.dhNotifyMessage=!0,e.appendChild(t),e.appendChild(n),e};dismiss=()=>{this.queueIsEmpty()||(this.notifyWrapper.removeChild(this.notifyWrapper.firstElementChild),this.queue-=1)};dismissAll=()=>{for(;!this.queueIsEmpty();)this.dismiss()};render=({title:t="",message:n,delay:o=this.DEFAULT_DELAY,actions:i=[]})=>{const s=this.notifyEl.cloneNode(!0);if(s.querySelector("[data-dh-notify-heading]").innerText=`[Dark Hole] ${t}`,n){s.querySelector("[data-dh-notify-message").innerText=n}if(i.length>0)for(const t of i){const n=document.createElement("button");e(n),n.dataset.dhNotifyAction=!0,n.innerText=t.label,n.addEventListener("click",(()=>{t.handler(),this.dismiss()})),s.appendChild(n)}this.notifyWrapper.appendChild(s),this.queue+=1,setTimeout(this.dismiss,o)}};function n(e){const n=`ðŸ›‘ Stopped script: Dark Hole - ${e}`;console.log({content:n}),t({content:n})}let o=!1;const i=e=>{"Escape"===e.key&&(o=!0)};async function s(e=[]){document.addEventListener("keydown",i,!0);let t=500;async function a(){return new Promise((e=>setTimeout((()=>requestAnimationFrame(e)),t)))}function l(){return[...document.querySelectorAll('[data-testid="tweet"]')]}let r=e.length?e:l();console.log("ðŸ§¹ Deleting bookmarks");for(const e of r){if(o)return n("Twitter Bookmarks"),void document.removeEventListener("keydown",i,!0);let t=e.querySelector('[data-testid="removeBookmark"]');t.click(),t=void 0,await a()}if(r=l(),t=void 0,r.length)return console.log("ðŸ§² There are more tweets to delete"),s(r);console.log("âœ¨ Done!")}!async function({pathname:e,title:n,urlPaths:o,handler:i,message:s="Ready to clean up your data?\nNOTE: this is a destructive action. Make sure you have a backup of your data before proceeding.",actionLabel:a="ðŸ§¹ Begin Removal"}){o.some((t=>e===t))&&t.render({title:n,message:s,actions:[{label:a,handler:i}],delay:6e4})}({pathname:window?.location?.pathname,title:"Twitter Bookmarks",handler:s,urlPaths:["/i/bookmarks"]})}();
